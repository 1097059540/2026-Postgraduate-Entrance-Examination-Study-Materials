<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>拉氏构象图(Ramachandran Plot)详解</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        h1 {
            text-align: center;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            border-left: 4px solid #3498db;
            padding-left: 10px;
            margin-top: 40px;
        }
        .container {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .highlight {
            background-color: #f1f9ff;
            border-left: 3px solid #3498db;
            padding: 15px;
            margin: 20px 0;
        }
        .figure {
            text-align: center;
            margin: 25px 0;
        }
        .figure img {
            max-width: 100%;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .figure-caption {
            font-style: italic;
            color: #666;
            margin-top: 10px;
        }
        .animation {
            width: 100%;
            height: 400px;
            margin: 20px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px 12px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .interactive {
            background-color: #f0f7ff;
            padding: 20px;
            border-radius: 8px;
            margin: 30px 0;
        }
        .tooltip {
            position: relative;
            display: inline-block;
            border-bottom: 1px dotted #3498db;
            cursor: help;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        #rama-canvas {
            border: 1px solid #ddd;
            display: block;
            margin: 20px auto;
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>拉氏构象图 (Ramachandran Plot) 详解</h1>
        
        <div class="highlight">
            <p>拉氏构象图（Ramachandran Plot）是蛋白质结构研究中的重要工具，它通过可视化多肽链中二面角的分布，帮助我们理解蛋白质的构象特性和立体化学限制。本页面将详细介绍拉氏构象图的概念、原理及其在蛋白质结构研究中的应用。</p>
        </div>

        <h2>1. 拉氏构象图的定义</h2>
        <p>拉氏构象图（Ramachandran Plot）是由印度生物物理学家G.N. Ramachandran于1963年首次提出的，用于描述多肽链中相邻氨基酸残基之间的构象关系。它是一个二维图，横轴表示φ（phi）二面角，纵轴表示ψ（psi）二面角，通过这两个角度的组合可以描述蛋白质主链的构象。两个角度的取值范围均为-180°到+180°。</p>
        
        <div class="figure">
            <svg width="500" height="500" viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">
                <!-- 背景 -->
                <rect x="50" y="50" width="400" height="400" fill="#f8f8f8" stroke="#ddd" stroke-width="1"/>
                
                <!-- 网格线 -->
                <line x1="150" y1="50" x2="150" y2="450" stroke="#ddd" stroke-width="1"/>
                <line x1="250" y1="50" x2="250" y2="450" stroke="#ddd" stroke-width="1"/>
                <line x1="350" y1="50" x2="350" y2="450" stroke="#ddd" stroke-width="1"/>
                
                <line x1="50" y1="150" x2="450" y2="150" stroke="#ddd" stroke-width="1"/>
                <line x1="50" y1="250" x2="450" y2="250" stroke="#ddd" stroke-width="1"/>
                <line x1="50" y1="350" x2="450" y2="350" stroke="#ddd" stroke-width="1"/>
                
                <!-- 坐标轴 -->
                <line x1="50" y1="250" x2="450" y2="250" stroke="black" stroke-width="2"/>
                <line x1="250" y1="50" x2="250" y2="450" stroke="black" stroke-width="2"/>
                
                <!-- 坐标轴标签 -->
                <text x="450" y="270" font-size="16">φ (phi)</text>
                <text x="230" y="40" font-size="16">ψ (psi)</text>
                
                <!-- 刻度值 -->
                <text x="50" y="270" font-size="12">-180°</text>
                <text x="150" y="270" font-size="12">-90°</text>
                <text x="245" y="270" font-size="12">0°</text>
                <text x="350" y="270" font-size="12">90°</text>
                <text x="440" y="270" font-size="12">180°</text>
                
                <text x="230" y="450" font-size="12">-180°</text>
                <text x="230" y="350" font-size="12">-90°</text>
                <text x="230" y="255" font-size="12">0°</text>
                <text x="230" y="150" font-size="12">90°</text>
                <text x="230" y="60" font-size="12">180°</text>
                
                <!-- 象限标记 -->
                <text x="150" y="150" font-size="14" fill="#666">第二象限</text>
                <text x="350" y="150" font-size="14" fill="#666">第一象限</text>
                <text x="150" y="350" font-size="14" fill="#666">第三象限</text>
                <text x="350" y="350" font-size="14" fill="#666">第四象限</text>
                
                <!-- 右手α螺旋区域 -->
                <ellipse cx="180" cy="300" rx="30" ry="25" fill="rgba(255, 100, 100, 0.5)" stroke="red" stroke-width="2"/>
                <text x="180" y="300" font-size="12" text-anchor="middle">右手α螺旋</text>
                
                <!-- 左手α螺旋区域 -->
                <ellipse cx="320" cy="200" rx="25" ry="20" fill="rgba(255, 180, 100, 0.5)" stroke="orange" stroke-width="2"/>
                <text x="320" y="200" font-size="12" text-anchor="middle">左手α螺旋</text>
                
                <!-- 平行β折叠区域 -->
                <ellipse cx="130" cy="130" rx="30" ry="25" fill="rgba(100, 100, 255, 0.5)" stroke="blue" stroke-width="2"/>
                <text x="130" y="130" font-size="12" text-anchor="middle">平行β折叠</text>
                
                <!-- 反平行β折叠区域 -->
                <ellipse cx="370" cy="130" rx="30" ry="25" fill="rgba(100, 180, 255, 0.5)" stroke="blue" stroke-width="2"/>
                <text x="370" y="130" font-size="12" text-anchor="middle">反平行β折叠</text>
                
                <!-- 胶原蛋白三螺旋区域 -->
                <ellipse cx="370" cy="370" rx="25" ry="25" fill="rgba(180, 100, 255, 0.5)" stroke="purple" stroke-width="2"/>
                <text x="370" y="370" font-size="12" text-anchor="middle">胶原三螺旋</text>
                
                <!-- 多聚脯氨酸II型螺旋区域 -->
                <ellipse cx="130" cy="370" rx="30" ry="25" fill="rgba(100, 255, 180, 0.5)" stroke="green" stroke-width="2"/>
                <text x="130" y="370" font-size="12" text-anchor="middle">PPII螺旋</text>
                
                <!-- 立体化学禁止区域 -->
                <path d="M 50 50 Q 150 80 250 50 Q 350 80 450 50 L 450 100 Q 350 130 250 100 Q 150 130 50 100 Z" fill="rgba(200,200,200,0.3)" stroke="gray" stroke-width="1.5"/>
                <text x="250" y="80" font-size="14" text-anchor="middle" fill="#666">立体化学禁止区域</text>
            </svg>
            <div class="figure-caption">图1：拉氏构象图示意，显示φ和ψ二面角的分布（-180°到+180°）以及四个象限中的主要二级结构区域</div>
        </div>

        <h2>2. 二面角的概念</h2>
        <p>在蛋白质多肽链中，每个氨基酸残基的主链部分包含三个关键原子：N（氮原子）、Cα（α碳原子）和C（羰基碳原子）。这些原子之间形成的二面角决定了多肽链的空间构象：</p>
        <ul>
            <li><strong>φ (phi) 二面角</strong>：由C(i-1)-N(i)-Cα(i)-C(i)四个原子定义的二面角</li>
            <li><strong>ψ (psi) 二面角</strong>：由N(i)-Cα(i)-C(i)-N(i+1)四个原子定义的二面角</li>
            <li><strong>ω (omega) 二面角</strong>：由Cα(i)-C(i)-N(i+1)-Cα(i+1)四个原子定义的二面角，通常接近180°（反式构象）</li>
        </ul>
        
        <div class="figure">
            <svg width="600" height="400" xmlns="http://www.w3.org/2000/svg">
                <!-- 3D效果的多肽链骨架示意图 -->
                <!-- 定义渐变 -->
                <defs>
                    <radialGradient id="blueGrad" cx="0.3" cy="0.3" r="0.8">
                        <stop offset="0%" stop-color="#fff" />
                        <stop offset="100%" stop-color="#0066cc" />
                    </radialGradient>
                    
                    <radialGradient id="grayGrad" cx="0.3" cy="0.3" r="0.8">
                        <stop offset="0%" stop-color="#fff" />
                        <stop offset="100%" stop-color="#666" />
                    </radialGradient>
                    
                    <radialGradient id="redGrad" cx="0.3" cy="0.3" r="0.8">
                        <stop offset="0%" stop-color="#fff" />
                        <stop offset="100%" stop-color="#cc3333" />
                    </radialGradient>
                    
                    <radialGradient id="greenGrad" cx="0.3" cy="0.3" r="0.8">
                        <stop offset="0%" stop-color="#fff" />
                        <stop offset="100%" stop-color="#33aa33" />
                    </radialGradient>
                    
                    <linearGradient id="peptideBond" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:rgb(100,100,100);stop-opacity:1" />
                        <stop offset="100%" style="stop-color:rgb(200,200,200);stop-opacity:1" />
                    </linearGradient>
                </defs>
                
                <!-- 空间平面表示 -->
                <polygon points="80,200 150,170 250,170 180,200" fill="rgba(230,230,250,0.6)" stroke="#aaa" stroke-width="1"/>
                <polygon points="180,200 250,170 350,190 280,220" fill="rgba(220,240,220,0.6)" stroke="#aaa" stroke-width="1"/>
                <polygon points="280,220 350,190 450,210 380,240" fill="rgba(250,230,220,0.6)" stroke="#aaa" stroke-width="1"/>
                
                <!-- 多肽链骨架 - 3D效果 -->
                <!-- N-Cα键 -->
                <line x1="80" y1="200" x2="180" y2="200" stroke="#6495ED" stroke-width="3"/>
                <!-- Cα-C键 -->
                <line x1="180" y1="200" x2="280" y2="220" stroke="#A9A9A9" stroke-width="3"/>
                <!-- C-N键（肽键） -->
                <line x1="280" y1="220" x2="380" y2="240" stroke="url(#peptideBond)" stroke-width="4"/>
                <!-- N-Cα键 -->
                <line x1="380" y1="240" x2="480" y2="260" stroke="#6495ED" stroke-width="3"/>
                
                <!-- 原子标记 - 3D效果 -->
                <!-- N原子 -->
                <circle cx="80" cy="200" r="18" fill="url(#blueGrad)"/>
                <text x="75" y="205" fill="white" font-weight="bold">N</text>
                
                <!-- Cα原子 -->
                <circle cx="180" cy="200" r="18" fill="url(#grayGrad)"/>
                <text x="170" y="205" fill="white" font-weight="bold">Cα</text>
                
                <!-- C原子 -->
                <circle cx="280" cy="220" r="18" fill="url(#redGrad)"/>
                <text x="275" y="225" fill="white" font-weight="bold">C</text>
                
                <!-- N原子 -->
                <circle cx="380" cy="240" r="18" fill="url(#blueGrad)"/>
                <text x="375" y="245" fill="white" font-weight="bold">N</text>
                
                <!-- Cα原子 -->
                <circle cx="480" cy="260" r="18" fill="url(#grayGrad)"/>
                <text x="470" y="265" fill="white" font-weight="bold">Cα</text>
                
                <!-- 氢原子和氧原子 - 增强3D效果 -->
                <circle cx="280" cy="180" r="12" fill="#FF4500"/>
                <text x="280" y="185" font-size="14" text-anchor="middle" fill="white">O</text>
                <line x1="280" y1="220" x2="280" y2="180" stroke="#CD5C5C" stroke-width="2"/>
                
                <circle cx="80" cy="160" r="10" fill="#FFFFFF" stroke="#000"/>
                <text x="80" y="165" font-size="14" text-anchor="middle">H</text>
                <line x1="80" y1="200" x2="80" y2="160" stroke="#0047AB" stroke-width="2"/>
                
                <circle cx="380" cy="200" r="10" fill="#FFFFFF" stroke="#000"/>
                <text x="380" y="205" font-size="14" text-anchor="middle">H</text>
                <line x1="380" y1="240" x2="380" y2="200" stroke="#0047AB" stroke-width="2"/>
                
                <!-- 侧链示意 - 3D效果 -->
                <line x1="180" y1="200" x2="160" y2="140" stroke="black" stroke-width="2"/>
                <circle cx="160" cy="140" r="12" fill="url(#greenGrad)"/>
                <text x="155" y="145" fill="white" font-weight="bold">R</text>
                
                <line x1="480" y1="260" x2="460" y2="200" stroke="black" stroke-width="2"/>
                <circle cx="460" cy="200" r="12" fill="url(#greenGrad)"/>
                <text x="455" y="205" fill="white" font-weight="bold">R</text>
                
                <!-- 二面角标记 - 更明显的3D效果 -->
                <!-- φ角 -->
                <path d="M 130,180 A 40,20 0 0 1 170,180" fill="none" stroke="purple" stroke-width="2.5" stroke-dasharray="4"/>
                <path d="M 130,180 L 140,170" stroke="purple" stroke-width="2"/>
                <path d="M 170,180 L 160,170" stroke="purple" stroke-width="2"/>
                <text x="145" y="165" fill="purple" font-weight="bold" font-size="16">φ</text>
                
                <!-- ψ角 -->
                <path d="M 230,200 A 40,20 0 0 1 270,210" fill="none" stroke="orange" stroke-width="2.5" stroke-dasharray="4"/>
                <path d="M 230,200 L 240,190" stroke="orange" stroke-width="2"/>
                <path d="M 270,210 L 260,200" stroke="orange" stroke-width="2"/>
                <text x="245" y="185" fill="orange" font-weight="bold" font-size="16">ψ</text>
                
                <!-- ω角 -->
                <path d="M 330,220 A 40,20 0 0 1 370,230" fill="none" stroke="green" stroke-width="2.5" stroke-dasharray="4"/>
                <path d="M 330,220 L 340,210" stroke="green" stroke-width="2"/>
                <path d="M 370,230 L 360,220" stroke="green" stroke-width="2"/>
                <text x="345" y="205" fill="green" font-weight="bold" font-size="16">ω</text>
                
                <!-- 二面角说明 -->
                <text x="50" y="320" font-size="14">φ (phi) 二面角: C(i-1)-N(i)-Cα(i)-C(i) 四个原子形成的二面角</text>
                <text x="50" y="345" font-size="14">ψ (psi) 二面角: N(i)-Cα(i)-C(i)-N(i+1) 四个原子形成的二面角</text>
                <text x="50" y="370" font-size="14">ω (omega) 二面角: Cα(i)-C(i)-N(i+1)-Cα(i+1) 四个原子形成的二面角</text>
            </svg>
            <div class="figure-caption">图2：多肽链中的二面角φ、ψ和ω的空间结构示意图。二面角是由四个连续原子形成的两个平面之间的夹角。</div>
        </div>

        <h2>3. 拉氏构象图的原理</h2>
        <p>拉氏构象图的核心原理基于以下几点：</p>
        
        <h3>3.1 立体化学限制</h3>
        <p>多肽链中的原子不能任意接近，因为它们之间存在排斥力（范德华排斥力）。当两个非键合原子距离小于它们的范德华半径之和时，会产生强烈的排斥力，这种构象在能量上是不稳定的，因此在自然界中很少出现。</p>
        
        <h3>3.2 允许区域与禁止区域</h3>
        <p>基于立体化学限制，拉氏构象图上的φ-ψ空间可以分为：</p>
        <ul>
            <li><strong>允许区域</strong>：这些区域中的φ-ψ组合不会导致原子间的严重碰撞，能量相对较低，构象稳定</li>
            <li><strong>禁止区域</strong>：这些区域中的φ-ψ组合会导致原子间的严重碰撞，能量很高，构象不稳定</li>
        </ul>
        
        <div class="highlight">
            <p>拉氏构象图表示出一个蛋白质多肽链中哪些α碳原子的φ-ψ二面角值在立体化学上是被允许的，哪些是不被允许的。这是因为某些二面角组合会导致多肽链中的原子发生空间碰撞，产生高能量的不稳定构象。</p>
        </div>

        <h2>4. 拉氏构象图中的主要区域</h2>
        <p>在拉氏构象图上，不同的区域对应着蛋白质中不同的二级结构：</p>
        
        <table>
            <tr>
                <th>区域</th>
                <th>φ角范围</th>
                <th>ψ角范围</th>
                <th>对应的二级结构</th>
                <th>特点</th>
            </tr>
            <tr>
                <td>右手α螺旋区</td>
                <td>-60°左右</td>
                <td>-45°左右</td>
                <td>右手α螺旋 (Right-handed α-helix)</td>
                <td>最常见的螺旋结构，每转3.6个氨基酸残基，螺距为5.4Å</td>
            </tr>
            <tr>
                <td>平行β折叠区</td>
                <td>-120°左右</td>
                <td>115°左右</td>
                <td>平行β折叠 (Parallel β-sheet)</td>
                <td>相邻肽链以相同方向排列，形成氢键</td>
            </tr>
            <tr>
                <td>反平行β折叠区</td>
                <td>-140°左右</td>
                <td>135°左右</td>
                <td>反平行β折叠 (Antiparallel β-sheet)</td>
                <td>相邻肽链以相反方向排列，氢键排列更直接，结构更稳定</td>
            </tr>
            <tr>
                <td>左手α螺旋区</td>
                <td>60°左右</td>
                <td>45°左右</td>
                <td>左手α螺旋 (Left-handed α-helix)</td>
                <td>在自然蛋白质中较少见，主要出现在含有甘氨酸的区域</td>
            </tr>
            <tr>
                <td>多聚脯氨酸II型螺旋区</td>
                <td>-75°左右</td>
                <td>150°左右</td>
                <td>多聚脯氨酸II型螺旋 (Polyproline II helix)</td>
                <td>左手螺旋，每转3个氨基酸残基，常见于富含脯氨酸的区域</td>
            </tr>
            <tr>
                <td>胶原三螺旋区</td>
                <td>-60°左右</td>
                <td>150°左右</td>
                <td>胶原三螺旋 (Collagen triple helix)</td>
                <td>三条多肽链缠绕形成超螺旋，富含甘氨酸-脯氨酸-羟脯氨酸重复序列</td>
            </tr>
            <tr>
                <td>π螺旋区</td>
                <td>-55°左右</td>
                <td>-70°左右</td>
                <td>π螺旋 (π-helix)</td>
                <td>较罕见的右手螺旋，每转4.1个氨基酸残基，比α螺旋更宽松</td>
            </tr>
            <tr>
                <td>310螺旋区</td>
                <td>-75°左右</td>
                <td>-15°左右</td>
                <td>310螺旋 (310-helix)</td>
                <td>较紧的右手螺旋，每转3个氨基酸残基，常出现在α螺旋末端</td>
            </tr>
        </table>

        <h2>5. 特殊氨基酸的拉氏构象图特点</h2>
        
        <h3>5.1 甘氨酸 (Glycine)</h3>
        <p>甘氨酸是最小的氨基酸，其侧链仅为一个氢原子，因此它在拉氏构象图上的允许区域比其他氨基酸更广泛。由于没有侧链的空间位阻，甘氨酸可以采取其他氨基酸无法采取的构象，特别是在左手α螺旋区域（φ角为正值）。这种独特的灵活性使得甘氨酸在蛋白质结构中常常出现在需要高度灵活性的位置，如β转角和紧密折叠区域。</p>
        
        <h3>5.2 脯氨酸 (Proline)</h3>
        <p>脯氨酸的侧链与其主链氮原子形成环状结构，这严重限制了它的φ角（约为-60°±15°）。由于这种环状结构，脯氨酸不能形成常规的α螺旋氢键，常常导致α螺旋的中断或扭曲。脯氨酸在拉氏构象图上的分布区域非常有限，主要集中在多聚脯氨酸II型螺旋区域（φ约为-75°，ψ约为150°）。这种构象限制解释了为什么脯氨酸常常导致多肽链的转向，在蛋白质折叠中起着关键的结构调节作用。</p>
        
        <div class="figure">
            <svg width="600" height="300" viewBox="0 0 600 300" xmlns="http://www.w3.org/2000/svg">
                <!-- 背景网格 -->
                <rect x="50" y="50" width="200" height="200" fill="#f8f8f8" stroke="#ddd" stroke-width="1"/>
                <rect x="350" y="50" width="200" height="200" fill="#f8f8f8" stroke="#ddd" stroke-width="1"/>
                
                <!-- 左侧：甘氨酸的拉氏构象图 -->
                <text x="150" y="30" text-anchor="middle" font-size="16" font-weight="bold">甘氨酸</text>
                
                <!-- 坐标轴 -->
                <line x1="50" y1="150" x2="250" y2="150" stroke="black" stroke-width="1.5"/>
                <line x1="150" y1="50" x2="150" y2="250" stroke="black" stroke-width="1.5"/>
                
                <!-- 坐标轴标签 -->
                <text x="255" y="150" font-size="14" font-weight="bold">φ</text>
                <text x="150" y="45" font-size="14" font-weight="bold">ψ</text>
                
                <!-- 刻度 -->
                <text x="50" y="145" font-size="10" text-anchor="middle">-180°</text>
                <text x="250" y="145" font-size="10" text-anchor="middle">180°</text>
                <text x="145" y="50" font-size="10" text-anchor="middle">180°</text>
                <text x="145" y="250" font-size="10" text-anchor="middle">-180°</text>
                
                <!-- 甘氨酸的广泛允许区域 -->
                <!-- 右手α螺旋区域 -->
                <ellipse cx="120" cy="120" rx="25" ry="25" fill="rgba(255,200,200,0.5)" stroke="red" stroke-width="1.5"/>
                <text x="120" y="120" text-anchor="middle" font-size="10">右手α螺旋</text>
                
                <!-- β折叠区域 -->
                <ellipse cx="90" cy="190" rx="25" ry="20" fill="rgba(200,200,255,0.5)" stroke="blue" stroke-width="1.5"/>
                <text x="90" y="190" text-anchor="middle" font-size="10">β折叠</text>
                
                <!-- 左手α螺旋区域（甘氨酸特有） -->
                <ellipse cx="180" cy="120" rx="25" ry="25" fill="rgba(255,150,150,0.5)" stroke="darkred" stroke-width="1.5"/>
                <text x="180" y="120" text-anchor="middle" font-size="10">左手α螺旋</text>
                
                <!-- 扩展允许区域（甘氨酸特有） -->
                <path d="M 150 80 Q 180 70 210 90 Q 230 120 210 150 Q 180 180 150 170 Q 120 160 110 130 Q 120 100 150 80 Z" fill="rgba(144, 238, 144, 0.3)" stroke="green" stroke-width="1"/>
                <text x="170" y="140" text-anchor="middle" font-size="10">扩展允许区域</text>
                
                <!-- 右侧：脯氨酸的拉氏构象图 -->
                <text x="450" y="30" text-anchor="middle" font-size="16" font-weight="bold">脯氨酸</text>
                
                <!-- 坐标轴 -->
                <line x1="350" y1="150" x2="550" y2="150" stroke="black" stroke-width="1.5"/>
                <line x1="450" y1="50" x2="450" y2="250" stroke="black" stroke-width="1.5"/>
                
                <!-- 坐标轴标签 -->
                <text x="555" y="150" font-size="14" font-weight="bold">φ</text>
                <text x="450" y="45" font-size="14" font-weight="bold">ψ</text>
                
                <!-- 刻度 -->
                <text x="350" y="145" font-size="10" text-anchor="middle">-180°</text>
                <text x="550" y="145" font-size="10" text-anchor="middle">180°</text>
                <text x="445" y="50" font-size="10" text-anchor="middle">180°</text>
                <text x="445" y="250" font-size="10" text-anchor="middle">-180°</text>
                
                <!-- 脯氨酸的有限允许区域 -->
                <!-- PPII螺旋区域（脯氨酸主要区域） -->
                <ellipse cx="425" cy="200" rx="20" ry="20" fill="rgba(100,255,180,0.6)" stroke="green" stroke-width="2"/>
                <text x="425" y="200" text-anchor="middle" font-size="10">PPII螺旋</text>
                
                <!-- 脯氨酸的φ角限制区域 -->
                <path d="M 390 100 L 390 200 L 460 200 L 460 100 Z" fill="rgba(255,200,100,0.2)" stroke="orange" stroke-width="1" stroke-dasharray="5,3"/>
                <text x="425" y="150" text-anchor="middle" font-size="10">φ角限制区域</text>
                <text x="425" y="165" text-anchor="middle" font-size="10">(-75°±15°)</text>
                
                <!-- 脯氨酸不能形成α螺旋的标记 -->
                <ellipse cx="420" cy="120" rx="25" ry="25" fill="rgba(255,200,200,0.2)" stroke="red" stroke-width="1" stroke-dasharray="5,3"/>
                <line x1="400" y1="100" x2="440" y2="140" stroke="red" stroke-width="2"/>
                <text x="420" y="90" text-anchor="middle" font-size="10">不能形成</text>
                <text x="420" y="105" text-anchor="middle" font-size="10">α螺旋</text>
            </svg>
            <div class="figure-caption">图3：甘氨酸和脯氨酸的拉氏构象图比较。甘氨酸由于没有侧链，允许区域更广泛，特别是在左手α螺旋区域；脯氨酸由于环状结构，φ角受到严格限制，主要分布在PPII螺旋区域。</div>
        </div>

        <h2>6. 拉氏构象图的应用</h2>
        
        <h3>6.1 蛋白质结构验证</h3>
        <p>拉氏构象图是评估蛋白质结构模型质量的重要工具。在高质量的蛋白质结构中，大多数残基的φ-ψ角应该落在拉氏构象图的允许区域内。如果有许多残基落在禁止区域，这可能表明结构模型存在问题。</p>
        
        <h3>6.2 蛋白质折叠研究</h3>
        <p>通过分析蛋白质折叠过程中φ-ψ角的变化，科学家可以了解蛋白质如何从无规则的初始状态转变为有序的天然构象。</p>
        
        <h3>6.3 蛋白质设计</h3>
        <p>在蛋白质设计中，研究人员可以利用拉氏构象图来预测特定氨基酸序列可能采取的构象，从而设计具有特定结构和功能的新蛋白质。</p>

        <h2>7. 交互式拉氏构象图演示</h2>
        
        <div class="interactive">
            <p>下面是一个简单的交互式拉氏构象图演示。您可以通过点击图上的不同位置来探索不同的φ-ψ组合，并查看它们对应的构象特点。</p>
            
            <div class="controls">
                <button id="show-alpha">显示α螺旋区域</button>
                <button id="show-beta">显示β折叠区域</button>
                <button id="show-all">显示所有允许区域</button>
                <button id="clear">清除</button>
            </div>
            
            <canvas id="rama-canvas" width="500" height="500"></canvas>
            
            <div id="angle-info">点击图上任意位置查看φ-ψ角信息</div>
        </div>

        <h2>8. 总结</h2>
        <p>拉氏构象图是理解蛋白质结构的强大工具，它揭示了多肽链构象的基本原理和限制条件。通过研究φ-ψ二面角的分布，我们可以：</p>
        <ul>
            <li>理解蛋白质主链构象的立体化学限制</li>
            <li>识别和预测蛋白质中的二级结构元素</li>
            <li>评估蛋白质结构模型的质量</li>
            <li>指导蛋白质设计和工程</li>
        </ul>
        
        <div class="highlight">
            <p>拉氏构象图之所以如此重要，是因为它将复杂的三维蛋白质结构简化为二维图表，使我们能够直观地理解和分析蛋白质构象的规律性。它是连接氨基酸序列与蛋白质三维结构的重要桥梁。</p>
        </div>
    </div>

    <script>
        // 拉氏构象图交互式演示的JavaScript代码
        document.addEventListener('DOMContentLoaded', function() {
            const canvas = document.getElementById('rama-canvas');
            const ctx = canvas.getContext('2d');
            const angleInfo = document.getElementById('angle-info');
            
            // 设置坐标系
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const scale = canvas.width / 400; // 缩放因子
            
            // 绘制坐标轴和网格
            function drawGrid() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // 绘制背景
                ctx.fillStyle = '#f8f8f8';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // 绘制网格
                ctx.strokeStyle = '#ddd';
                ctx.lineWidth = 1;
                
                // 垂直网格线
                for (let x = -180; x <= 180; x += 30) {
                    const canvasX = centerX + x * scale;
                    ctx.beginPath();
                    ctx.moveTo(canvasX, 0);
                    ctx.lineTo(canvasX, canvas.height);
                    ctx.stroke();
                }
                
                // 水平网格线
                for (let y = -180; y <= 180; y += 30) {
                    const canvasY = centerY - y * scale;
                    ctx.beginPath();
                    ctx.moveTo(0, canvasY);
                    ctx.lineTo(canvas.width, canvasY);
                    ctx.stroke();
                }
                
                // 绘制坐标轴
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 2;
                
                // X轴
                ctx.beginPath();
                ctx.moveTo(0, centerY);
                ctx.lineTo(canvas.width, centerY);
                ctx.stroke();
                
                // Y轴
                ctx.beginPath();
                ctx.moveTo(centerX, 0);
                ctx.lineTo(centerX, canvas.height);
                ctx.stroke();
                
                // 坐标轴标签
                ctx.fillStyle = '#000';
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                
                // X轴标签
                ctx.fillText('φ (phi)', canvas.width - 30, centerY + 30);
                ctx.fillText('-180°', 30, centerY + 20);
                ctx.fillText('0°', centerX, centerY + 20);
                ctx.fillText('180°', canvas.width - 30, centerY + 20);
                
                // Y轴标签
                ctx.fillText('ψ (psi)', centerX - 50, 20);
                ctx.fillText('180°', centerX - 30, 20);
                ctx.fillText('0°', centerX - 30, centerY + 5);
                ctx.fillText('-180°', centerX - 30, canvas.height - 10);
                
                // 添加象限标记
                ctx.font = '14px Arial';
                ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
                ctx.fillText('第二象限', centerX - 100, centerY - 100);
                ctx.fillText('第一象限', centerX + 100, centerY - 100);
                ctx.fillText('第三象限', centerX - 100, centerY + 100);
                ctx.fillText('第四象限', centerX + 100, centerY + 100);
                
                // 添加坐标轴范围说明
                ctx.font = '12px Arial';
                ctx.fillStyle = '#666';
                ctx.fillText('φ和ψ角度范围均为-180°到+180°', centerX, canvas.height - 10);
            }
            
            // 绘制右手α螺旋区域
            function drawAlphaRegion() {
                ctx.beginPath();
                ctx.ellipse(centerX - 60 * scale, centerY + 45 * scale, 30 * scale, 30 * scale, 0, 0, 2 * Math.PI);
                ctx.fillStyle = 'rgba(255, 100, 100, 0.5)';
                ctx.fill();
                ctx.strokeStyle = 'red';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                ctx.fillStyle = '#000';
                ctx.font = '16px Arial';
                ctx.fillText('右手α螺旋', centerX - 60 * scale, centerY + 45 * scale);
            }
            
            // 绘制左手α螺旋区域
            function drawLeftAlphaRegion() {
                ctx.beginPath();
                ctx.ellipse(centerX + 60 * scale, centerY - 45 * scale, 25 * scale, 25 * scale, 0, 0, 2 * Math.PI);
                ctx.fillStyle = 'rgba(255, 180, 100, 0.5)';
                ctx.fill();
                ctx.strokeStyle = 'orange';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                ctx.fillStyle = '#000';
                ctx.font = '16px Arial';
                ctx.fillText('左手α螺旋', centerX + 60 * scale, centerY - 45 * scale);
            }
            
            // 绘制平行β折叠区域
            function drawBetaRegion() {
                ctx.beginPath();
                ctx.ellipse(centerX - 120 * scale, centerY - 120 * scale, 40 * scale, 30 * scale, 0, 0, 2 * Math.PI);
                ctx.fillStyle = 'rgba(100, 100, 255, 0.5)';
                ctx.fill();
                ctx.strokeStyle = 'blue';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                ctx.fillStyle = '#000';
                ctx.font = '16px Arial';
                ctx.fillText('平行β折叠', centerX - 120 * scale, centerY - 120 * scale);
            }
            
            // 绘制反平行β折叠区域
            function drawAntiBetaRegion() {
                ctx.beginPath();
                ctx.ellipse(centerX + 120 * scale, centerY - 120 * scale, 40 * scale, 30 * scale, 0, 0, 2 * Math.PI);
                ctx.fillStyle = 'rgba(100, 180, 255, 0.5)';
                ctx.fill();
                ctx.strokeStyle = 'blue';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                ctx.fillStyle = '#000';
                ctx.font = '16px Arial';
                ctx.fillText('反平行β折叠', centerX + 120 * scale, centerY - 120 * scale);
            }
            
            // 绘制胶原蛋白三螺旋区域
            function drawCollagenRegion() {
                ctx.beginPath();
                ctx.ellipse(centerX + 120 * scale, centerY + 120 * scale, 25 * scale, 25 * scale, 0, 0, 2 * Math.PI);
                ctx.fillStyle = 'rgba(180, 100, 255, 0.5)';
                ctx.fill();
                ctx.strokeStyle = 'purple';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                ctx.fillStyle = '#000';
                ctx.font = '16px Arial';
                ctx.fillText('胶原三螺旋', centerX + 120 * scale, centerY + 120 * scale);
            }
            
            // 绘制PPII螺旋区域
            function drawPPIIRegion() {
                ctx.beginPath();
                ctx.ellipse(centerX - 120 * scale, centerY + 120 * scale, 30 * scale, 25 * scale, 0, 0, 2 * Math.PI);
                ctx.fillStyle = 'rgba(100, 255, 180, 0.5)';
                ctx.fill();
                ctx.strokeStyle = 'green';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                ctx.fillStyle = '#000';
                ctx.font = '16px Arial';
                ctx.fillText('PPII螺旋', centerX - 120 * scale, centerY + 120 * scale);
            }
            
            // 绘制π螺旋区域
            function drawPiRegion() {
                ctx.beginPath();
                ctx.ellipse(centerX - 55 * scale, centerY + 70 * scale, 20 * scale, 20 * scale, 0, 0, 2 * Math.PI);
                ctx.fillStyle = 'rgba(255, 100, 150, 0.5)';
                ctx.fill();
                ctx.strokeStyle = 'pink';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                ctx.fillStyle = '#000';
                ctx.font = '16px Arial';
                ctx.fillText('π螺旋', centerX - 55 * scale, centerY + 70 * scale);
            }
            
            // 绘制310螺旋区域
            function draw310Region() {
                ctx.beginPath();
                ctx.ellipse(centerX - 75 * scale, centerY + 15 * scale, 20 * scale, 20 * scale, 0, 0, 2 * Math.PI);
                ctx.fillStyle = 'rgba(255, 255, 100, 0.5)';
                ctx.fill();
                ctx.strokeStyle = 'gold';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                ctx.fillStyle = '#000';
                ctx.font = '16px Arial';
                ctx.fillText('310螺旋', centerX - 75 * scale, centerY + 15 * scale);
            }
            
            // 绘制所有允许区域
            function drawAllowedRegions() {
                // 主要允许区域
                ctx.beginPath();
                ctx.moveTo(centerX - 100 * scale, centerY - 50 * scale);
                ctx.bezierCurveTo(
                    centerX - 50 * scale, centerY - 150 * scale,
                    centerX + 50 * scale, centerY - 150 * scale,
                    centerX + 100 * scale, centerY - 50 * scale
                );
                ctx.bezierCurveTo(
                    centerX + 150 * scale, centerY,
                    centerX + 150 * scale, centerY + 50 * scale,
                    centerX + 100 * scale, centerY + 100 * scale
                );
                ctx.bezierCurveTo(
                    centerX + 50 * scale, centerY + 150 * scale,
                    centerX - 50 * scale, centerY + 150 * scale,
                    centerX - 100 * scale, centerY + 100 * scale
                );
                ctx.bezierCurveTo(
                    centerX - 150 * scale, centerY + 50 * scale,
                    centerX - 150 * scale, centerY,
                    centerX - 100 * scale, centerY - 50 * scale
                );
                ctx.fillStyle = 'rgba(144, 238, 144, 0.3)';
                ctx.fill();
                ctx.strokeStyle = 'green';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // 次要允许区域
                ctx.beginPath();
                ctx.ellipse(centerX + 60 * scale, centerY - 45 * scale, 25 * scale, 25 * scale, 0, 0, 2 * Math.PI);
                ctx.fillStyle = 'rgba(144, 238, 144, 0.3)';
                ctx.fill();
                ctx.strokeStyle = 'green';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                ctx.fillStyle = '#000';
                ctx.font = '14px Arial';
                ctx.fillText('允许区域', centerX, centerY - 100 * scale);
                
                // 绘制所有二级结构区域
                drawAlphaRegion();
                drawLeftAlphaRegion();
                drawBetaRegion();
                drawAntiBetaRegion();
                drawCollagenRegion();
                drawPPIIRegion();
                drawPiRegion();
                draw310Region();
            }
            
            // 初始绘制
            drawGrid();
            
            // 点击事件处理
            canvas.addEventListener('click', function(event) {
                const rect = canvas.getBoundingClientRect();
                const x = event.clientX - rect.left;
                const y = event.clientY - rect.top;
                
                // 计算φ和ψ角度
                const phi = Math.round((x - centerX) / scale);
                const psi = Math.round((centerY - y) / scale);
                
                // 更新角度信息
                angleInfo.innerHTML = `φ (phi): ${phi}°, ψ (psi): ${psi}°`;
                
                // 判断点击位置所在区域
                let regionInfo = '这个位置在';
                
                // 扩展的区域判断逻辑
                if (Math.pow((x - (centerX - 60 * scale)), 2) / Math.pow(30 * scale, 2) + 
                    Math.pow((y - (centerY + 45 * scale)), 2) / Math.pow(30 * scale, 2) <= 1) {
                    regionInfo += '右手α螺旋区域，是一个常见的二级结构元素。';
                } else if (Math.pow((x - (centerX - 120 * scale)), 2) / Math.pow(40 * scale, 2) + 
                           Math.pow((y - (centerY - 120 * scale)), 2) / Math.pow(30 * scale, 2) <= 1) {
                    regionInfo += '平行β折叠区域，是一个常见的二级结构元素。';
                } else if (Math.pow((x - (centerX + 120 * scale)), 2) / Math.pow(40 * scale, 2) + 
                           Math.pow((y - (centerY - 120 * scale)), 2) / Math.pow(30 * scale, 2) <= 1) {
                    regionInfo += '反平行β折叠区域，是一个常见的二级结构元素。';
                } else if (Math.pow((x - (centerX + 60 * scale)), 2) / Math.pow(25 * scale, 2) + 
                           Math.pow((y - (centerY - 45 * scale)), 2) / Math.pow(25 * scale, 2) <= 1) {
                    regionInfo += '左手α螺旋区域，在含有甘氨酸的区域较常见。';
                } else if (Math.pow((x - (centerX - 55 * scale)), 2) / Math.pow(20 * scale, 2) + 
                           Math.pow((y - (centerY + 70 * scale)), 2) / Math.pow(20 * scale, 2) <= 1) {
                    regionInfo += 'π螺旋区域，是一种较罕见的右手螺旋结构。';
                } else if (Math.pow((x - (centerX - 75 * scale)), 2) / Math.pow(20 * scale, 2) + 
                           Math.pow((y - (centerY + 15 * scale)), 2) / Math.pow(20 * scale, 2) <= 1) {
                    regionInfo += '310螺旋区域，是一种较紧的右手螺旋结构。';
                } else {
                    // 简化的允许区域判断
                    const inMainAllowedRegion = 
                        (Math.pow((x - centerX), 2) / Math.pow(150 * scale, 2) + 
                         Math.pow((y - centerY), 2) / Math.pow(150 * scale, 2) <= 1);
                    
                    const inSecondaryAllowedRegion = 
                        (Math.pow((x - (centerX + 60 * scale)), 2) / Math.pow(25 * scale, 2) + 
                         Math.pow((y - (centerY - 45 * scale)), 2) / Math.pow(25 * scale, 2) <= 1);
                    
                    if (inMainAllowedRegion || inSecondaryAllowedRegion) {
                        regionInfo += '允许区域，这种构象在立体化学上是稳定的。';
                    } else {
                        regionInfo += '禁止区域，这种构象在立体化学上是不稳定的，因为会导致原子间的空间碰撞。';
                    }
                }
                
                angleInfo.innerHTML += '<br>' + regionInfo;
                
                // 在点击位置绘制一个点
                drawGrid(); // 重绘网格
                drawAllowedRegions(); // 重绘所有区域
                ctx.beginPath();
                ctx.arc(x, y, 5, 0, 2 * Math.PI);
                ctx.fillStyle = 'red';
                ctx.fill();
            });
            
            // 按钮事件处理
            document.getElementById('show-alpha').addEventListener('click', function() {
                drawGrid();
                drawAlphaRegion();
                drawLeftAlphaRegion();
                draw310Region();
                drawPiRegion();
            });
            
            document.getElementById('show-beta').addEventListener('click', function() {
                drawGrid();
                drawBetaRegion();
                drawAntiBetaRegion();
            });
            
            document.getElementById('show-all').addEventListener('click', function() {
                drawGrid();
                drawAllowedRegions();
            });
            
            document.getElementById('clear').addEventListener('click', function() {
                drawGrid();
                angleInfo.innerHTML = '点击图上任意位置查看φ-ψ角信息';
            });
        });
    </script>
</body>
</html>